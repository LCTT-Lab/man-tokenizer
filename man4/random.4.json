[
  {
    "type": "comment",
    "lines": [
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" Copyright (c) 1997 John S. Kallal (kallal@voicenet.com)"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\""
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" %%%LICENSE_START(GPLv2+_DOC_ONEPARA)"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" This is free documentation; you can redistribute it and/or"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" modify it under the terms of the GNU General Public License as"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" published by the Free Software Foundation; either version 2 of"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" the License, or (at your option) any later version."
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" %%%LICENSE_END"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\""
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" Some changes by tytso and aeb."
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\""
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" 2004-12-16, John V. Belmonte/mtk, Updated init and quit scripts"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" 2004-04-08, AEB, Improved description of read from /dev/urandom"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" 2008-06-20, George Spelvin <linux@horizon.com>,"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\"             Matt Mackall <mpm@selenic.com>"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\""
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TH",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " RANDOM 4 2017-09-15 \"Linux\" \"Linux Programmer's Manual\""
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".SH",
          "translatable": true
        },
        {
          "type": "TEXT",
          "content": " NAME"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "random, urandom "
        },
        {
          "type": "ESCAPE",
          "content": "\\-"
        },
        {
          "type": "TEXT",
          "content": " kernel random number source devices"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".SH",
          "translatable": true
        },
        {
          "type": "TEXT",
          "content": " SYNOPSIS"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "#include <linux/random.h>"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".BI",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " \"int ioctl(\" fd \", RND\" request \", \" param \");\""
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".SH",
          "translatable": true
        },
        {
          "type": "TEXT",
          "content": " DESCRIPTION"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "The character special files "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/random"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P and"
        }
      ],
      [
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/urandom"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P (present since Linux 1.3.30)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "provide an interface to the kernel's random number generator."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "The file"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/random"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "has major device number 1 and minor device number 8."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "The file"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/urandom"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "has major device number 1 and minor device number 9."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "The random number generator gathers environmental noise"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "from device drivers and other sources into an entropy pool."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "The generator also keeps an estimate of the"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "number of bits of noise in the entropy pool."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "From this entropy pool, random numbers are created."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "Linux 3.17 and later provides the simpler and safer"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " getrandom (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "interface which requires no special files;"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "see the"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " getrandom (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "manual page for details."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "When read, the"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/urandom"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "device returns random bytes using a pseudorandom"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "number generator seeded from the entropy pool."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "Reads from this device do not block (i.e., the CPU is not yielded),"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "but can incur an appreciable delay when requesting large amounts of data."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "When read during early boot time,"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/urandom"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "may return data prior to the entropy pool being initialized."
        }
      ]
    ]
  },
  {
    "type": "comment",
    "lines": [
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" This is a real problem; see"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" commit 9b4d008787f864f17d008c9c15bbe8a0f7e2fc24"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "If this is of concern in your application, use"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " getrandom (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "or "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/random"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P instead."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "The "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/random"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P device is a legacy interface which dates back to"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "a time where the cryptographic primitives used in the implementation"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "of "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/urandom"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P were not widely trusted."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "It will return random bytes only within the estimated number of"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "bits of fresh noise in the entropy pool, blocking if necessary."
        }
      ],
      [
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/random"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P is suitable for applications that need"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "high quality randomness, and can afford indeterminate delays."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "When the entropy pool is empty, reads from "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/random"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P will block"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "until additional environmental noise is gathered."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "If"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " open (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "is called for"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/random"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "with the"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " O_NONBLOCK"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "flag, a subsequent"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " read (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "will not block if the requested number of bytes is not available."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "Instead, the available bytes are returned."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "If no byte is available,"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " read (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "will return -1 and"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " errno"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "will be set to"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " EAGAIN ."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "The"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".B",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " O_NONBLOCK"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "flag has no effect when opening"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/urandom ."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "When calling"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " read (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "for the device"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/urandom ,"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "reads of up to 256 bytes will return as many bytes as are requested"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "and will not be interrupted by a signal handler."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "Reads with a buffer over this limit may return less than the"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "requested number of bytes or fail with the error"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " EINTR ,"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "if interrupted by a signal handler."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "Since Linux 3.16,"
        }
      ]
    ]
  },
  {
    "type": "comment",
    "lines": [
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" commit 79a8468747c5f95ed3d5ce8376a3e82e0c5857fc"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "a"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " read (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "from"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/urandom"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "will return at most 32"
        },
        {
          "type": "ESCAPE",
          "content": "\\ "
        },
        {
          "type": "TEXT",
          "content": "MB."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "A"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " read (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "from"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/random"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "will return at most 512 bytes"
        }
      ]
    ]
  },
  {
    "type": "comment",
    "lines": [
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" SEC_XFER_SIZE in drivers/char/random.c"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "(340 bytes on Linux kernels before version 2.6.12)."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "Writing to "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/random"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P or "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/urandom"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P will update the"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "entropy pool with the data written, but this will not result in a"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "higher entropy count."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "This means that it will impact the contents"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "read from both files, but it will not make reads from"
        }
      ],
      [
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/random"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P faster."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".SS",
          "translatable": true
        },
        {
          "type": "TEXT",
          "content": " Usage"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "The"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/random"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "interface is considered a legacy interface, and"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/urandom"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "is preferred and sufficient in all use cases, with the exception of"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "applications which require randomness during early boot time; for"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "these applications,"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " getrandom (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "must be used instead,"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "because it will block until the entropy pool is initialized."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "If a seed file is saved across reboots as recommended below (all major"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "Linux distributions have done this since 2000 at least), the output is"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "cryptographically secure against attackers without local root access as"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "soon as it is reloaded in the boot sequence, and perfectly adequate for"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "network encryption session keys."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "Since reads from"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/random"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "may block, users will usually want to open it in nonblocking mode"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "(or perform a read with timeout),"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "and provide some sort of user notification if the desired"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "entropy is not immediately available."
        }
      ]
    ]
  },
  {
    "type": "comment",
    "lines": [
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\""
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".SS",
          "translatable": true
        },
        {
          "type": "TEXT",
          "content": " Configuration"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "If your system does not have"
        }
      ],
      [
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/random"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P and "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/urandom"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P created already, they"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "can be created with the following commands:"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".in",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " +4n"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": ".EX"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "mknod "
        },
        {
          "type": "ESCAPE",
          "content": "\\-"
        },
        {
          "type": "TEXT",
          "content": "m 666 /dev/random c 1 8"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "mknod "
        },
        {
          "type": "ESCAPE",
          "content": "\\-"
        },
        {
          "type": "TEXT",
          "content": "m 666 /dev/urandom c 1 9"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "chown root:root /dev/random /dev/urandom"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": ".EE"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".in",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "When a Linux system starts up without much operator interaction,"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "the entropy pool may be in a fairly predictable state."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "This reduces the actual amount of noise in the entropy pool"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "below the estimate."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "In order to counteract this effect, it helps to carry"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "entropy pool information across shut-downs and start-ups."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "To do this, add the lines to an appropriate script"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "which is run during the Linux system start-up sequence:"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".in",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " +4n"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": ".EX"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "echo \"Initializing random number generator...\""
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "random_seed=/var/run/random-seed"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "# Carry a random seed from start-up to start-up"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "# Load and then save the whole entropy pool"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "if [ "
        },
        {
          "type": "ESCAPE",
          "content": "\\-"
        },
        {
          "type": "TEXT",
          "content": "f $random_seed ]; then"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "    cat $random_seed >/dev/urandom"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "else"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "    touch $random_seed"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "fi"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "chmod 600 $random_seed"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "poolfile=/proc/sys/kernel/random/poolsize"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "[ "
        },
        {
          "type": "ESCAPE",
          "content": "\\-"
        },
        {
          "type": "TEXT",
          "content": "r $poolfile ] && bits=$(cat $poolfile) || bits=4096"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "bytes=$(expr $bits / 8)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "dd if=/dev/urandom of=$random_seed count=1 bs=$bytes"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": ".EE"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".in",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "Also, add the following lines in an appropriate script which is"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "run during the Linux system shutdown:"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".in",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " +4n"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": ".EX"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "# Carry a random seed from shut-down to start-up"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "# Save the whole entropy pool"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "echo \"Saving random seed...\""
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "random_seed=/var/run/random-seed"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "touch $random_seed"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "chmod 600 $random_seed"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "poolfile=/proc/sys/kernel/random/poolsize"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "[ "
        },
        {
          "type": "ESCAPE",
          "content": "\\-"
        },
        {
          "type": "TEXT",
          "content": "r $poolfile ] && bits=$(cat $poolfile) || bits=4096"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "bytes=$(expr $bits / 8)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "dd if=/dev/urandom of=$random_seed count=1 bs=$bytes"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": ".EE"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".in",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "In the above examples, we assume Linux 2.6.0 or later, where"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /proc/sys/kernel/random/poolsize"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "returns the size of the entropy pool in bits (see below)."
        }
      ]
    ]
  },
  {
    "type": "comment",
    "lines": [
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\""
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".SS",
          "translatable": true
        },
        {
          "type": "TEXT",
          "content": " /proc interfaces"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "The files in the directory"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /proc/sys/kernel/random"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "(present since 2.3.16) provide additional information about the"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/random"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "device:"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " entropy_avail"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "This read-only file gives the available entropy, in bits."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "This will be a number in the range 0 to 4096."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " poolsize"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "This file"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "gives the size of the entropy pool."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "The semantics of this file vary across kernel versions:"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".RS",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "Linux 2.4:"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "This file gives the size of the entropy pool in"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " bytes ."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "Normally, this file will have the value 512, but it is writable,"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "and can be changed to any value for which an algorithm is available."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "The choices are 32, 64, 128, 256, 512, 1024, or 2048."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "Linux 2.6 and later:"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "This file is read-only, and gives the size of the entropy pool in"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " bits ."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "It contains the value 4096."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".RE",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " read_wakeup_threshold"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "This file"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "contains the number of bits of entropy required for waking up processes"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "that sleep waiting for entropy from"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/random ."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "The default is 64."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " write_wakeup_threshold"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "This file"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "contains the number of bits of entropy below which we wake up"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "processes that do a"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " select (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "or"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " poll (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "for write access to"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/random ."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "These values can be changed by writing to the files."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".IR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " uuid \" and \" boot_id"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "These read-only files"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "contain random strings like 6fd5a44b-35f4-4ad4-a9b9-6b9be13e1fe9."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "The former is generated afresh for each read, the latter was"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "generated once."
        }
      ]
    ]
  },
  {
    "type": "comment",
    "lines": [
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\""
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".SS",
          "translatable": true
        },
        {
          "type": "TEXT",
          "content": " ioctl(2) interface"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "The following"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " ioctl (2)"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "requests are defined on file descriptors connected to either "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/random"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "or "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/urandom"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "All requests performed will interact with the input"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "entropy pool impacting both "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/random"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P and "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/urandom"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "The"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".B",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " CAP_SYS_ADMIN"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "capability is required for all requests except"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " RNDGETENTCNT ."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " RNDGETENTCNT"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "Retrieve the entropy count of the input pool, the contents will be the same"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "as the"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " entropy_avail"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "file under proc."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "The result will be stored in the int pointed to by the argument."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " RNDADDTOENTCNT"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "Increment or decrement the entropy count of the input pool"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "by the value pointed to by the argument."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " RNDGETPOOL"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "Removed in Linux 2.6.9."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " RNDADDENTROPY"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "Add some additional entropy to the input pool,"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "incrementing the entropy count."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "This differs from writing to "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/random"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P or "
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "I/dev/urandom"
        },
        {
          "type": "ESCAPE",
          "content": "\\f"
        },
        {
          "type": "TEXT",
          "content": "P,"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "which only adds some"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "data but does not increment the entropy count."
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "The following structure is used:"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".IP",
          "translatable": true
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".in",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " +4n"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": ".EX"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "struct rand_pool_info {"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "    int    entropy_count;"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "    int    buf_size;"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "    __u32  buf[0];"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "};"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": ".EE"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".in",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".IP",
          "translatable": true
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "Here"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " entropy_count"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "is the value added to (or subtracted from) the entropy count, and"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " buf"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "is the buffer of size"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " buf_size"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "which gets added to the entropy pool."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".TP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " RNDZAPENTCNT \", \" RNDCLEARPOOL"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "Zero the entropy count of all pools and add some system data (such as"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "wall clock) to the pools."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".SH",
          "translatable": true
        },
        {
          "type": "TEXT",
          "content": " FILES"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/random"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".br",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/urandom"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".SH",
          "translatable": true
        },
        {
          "type": "TEXT",
          "content": " NOTES"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "For an overview and comparison of the various interfaces that"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "can be used to obtain randomness, see"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " random (7)."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".SH",
          "translatable": true
        },
        {
          "type": "TEXT",
          "content": " BUGS"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "During early boot time, reads from"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".I",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " /dev/urandom"
        }
      ],
      [
        {
          "type": "TEXT",
          "content": "may return data prior to the entropy pool being initialized."
        }
      ]
    ]
  },
  {
    "type": "comment",
    "lines": [
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" .SH AUTHOR"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" The kernel's random number generator was written by"
        }
      ],
      [
        {
          "type": "COMMENT_BLOCK",
          "content": ".\\\" Theodore Ts'o (tytso@athena.mit.edu)."
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".SH",
          "translatable": true
        },
        {
          "type": "TEXT",
          "content": " SEE ALSO"
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " mknod (1),"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " getrandom (2),"
        }
      ],
      [
        {
          "type": "MACRO_INLINE",
          "content": ".BR",
          "translatable": false
        },
        {
          "type": "TEXT",
          "content": " random (7)"
        }
      ]
    ]
  },
  {
    "type": "macro",
    "lines": [
      [
        {
          "type": "MACRO_BLOCK",
          "content": ".PP",
          "translatable": false
        }
      ]
    ]
  },
  {
    "type": "content",
    "lines": [
      [
        {
          "type": "TEXT",
          "content": "RFC"
        },
        {
          "type": "ESCAPE",
          "content": "\\ "
        },
        {
          "type": "TEXT",
          "content": "1750, \"Randomness Recommendations for Security\""
        }
      ]
    ]
  }
]
